(()=>{"use strict";var e,t={539:()=>{const e=window.wp.i18n,t=window.wp.blocks,l=window.wp.blockEditor,i=window.wp.components,s=window.wp.element,a=JSON.parse('{"UU":"child/book-rating"}'),r=window.ReactJSXRuntime,n=e=>{if(!e)return"";let t=e.replace(/^http:\/\//i,"https://");return t.includes("zoom=")&&(t=t.replace(/zoom=\d/g,"zoom=2")),t},o=[1,2,3,4,5],c=({bookTitle:t,author:l,coverUrl:i,rating:s,onRatingChange:a})=>{if(!t?.trim())return(0,r.jsx)("div",{className:"book-preview--empty",children:(0,e.__)("Bitte wÃ¤hle ein Buch aus der Suche aus oder gib die Details manuell ein.","child")});const n=Number.isFinite(s)?Math.max(0,Math.min(5,s)):0;return(0,r.jsxs)("div",{className:"child-book-card","aria-label":(0,e.__)("Buchbewertung","child"),children:[(0,r.jsxs)("div",{className:"child-book-card__panel",children:[i?(0,r.jsx)("div",{className:"child-book-card__frame",children:(0,r.jsx)("img",{className:"child-book-card__cover",src:i,alt:t,loading:"lazy"})}):(0,r.jsx)("div",{className:"child-book-card__cover child-book-card__cover--placeholder","aria-hidden":"true"}),(0,r.jsx)("div",{className:"child-book-card__stars","aria-label":(0,e.__)("Bewertung","child"),children:o.map(t=>(0,r.jsx)("button",{type:"button",className:"child-book-card__star-btn"+(t<=n?" is-active":""),onClick:()=>{"function"==typeof a&&a(t)},"aria-pressed":t<=n,"aria-label":(0,e.sprintf)(/* translators: %d: selected star */ /* translators: %d: selected star */
(0,e.__)("Bewertung mit %d Sternen wÃ¤hlen","child"),t),children:"â˜…"},t))})]}),(0,r.jsxs)("div",{className:"child-book-card__meta",children:[(0,r.jsx)("h3",{className:"child-book-card__title",children:t}),l?.trim()?(0,r.jsx)("p",{className:"child-book-card__author",children:(0,e.sprintf)(/* translators: %s: author name */ /* translators: %s: author name */
(0,e.__)("Von %s","child"),l)}):null]})]})},h=({value:t=0,onChange:l})=>{const s=Number.isFinite(t)?Math.max(0,Math.min(5,t)):0,a=e=>{"function"==typeof l&&l(e)};return(0,r.jsxs)("div",{className:"book-rating-control",children:[(0,r.jsxs)("div",{className:"book-rating-control__label",children:[(0,r.jsx)("span",{children:(0,e.__)("Bewertung","child")}),(0,r.jsxs)("span",{className:"book-rating-control__value",children:[s,"/5"]})]}),(0,r.jsx)("div",{className:"book-rating-control__stars","aria-label":(0,e.__)("Bewertung auswÃ¤hlen","child"),children:o.map(t=>(0,r.jsx)("button",{type:"button",className:"child-book-card__star-btn"+(t<=s?" is-active":""),onClick:()=>a(t),"aria-pressed":t<=s,"aria-label":(0,e.sprintf)(/* translators: %d: selected star */ /* translators: %d: selected star */
(0,e.__)("Bewertung mit %d Sternen wÃ¤hlen","child"),t),children:"â˜…"},t))}),(0,r.jsx)(i.RangeControl,{value:s,min:0,max:5,step:1,onChange:e=>a(Number(e)||0),__nextHasNoMarginBottom:!0})]})},d=({results:e,selectedId:t,onSelect:l})=>e.length?(0,r.jsx)("div",{className:"book-search-results",children:e.map(e=>(0,r.jsxs)(i.Button,{variant:e.id===t?"primary":"secondary",onClick:()=>l(e),className:"book-search-result"+(e.id===t?" is-active":""),children:[e.cover?(0,r.jsx)("span",{className:"book-search-result__thumb",children:(0,r.jsx)("img",{src:e.cover,alt:e.title||"",loading:"lazy"})}):(0,r.jsx)("span",{className:"book-search-result__thumb book-search-result__thumb--placeholder","aria-hidden":"true",children:"ðŸ“˜"}),(0,r.jsxs)("span",{className:"book-search-result__details",children:[(0,r.jsx)("span",{className:"book-search-result__title",children:e.title}),e.subtitle?(0,r.jsx)("span",{className:"book-search-result__subtitle",children:e.subtitle}):null,e.authors.length?(0,r.jsx)("span",{className:"book-search-result__author",children:e.authors.join(", ")}):null]})]},e.id))}):null;(0,t.registerBlockType)(a.UU,{edit:function({attributes:t,setAttributes:a}){const o=(0,l.useBlockProps)(),{bookTitle:u,author:_,rating:b,coverUrl:m}=t,[p,v]=(0,s.useState)(""),[g,x]=(0,s.useState)(!1),[k,j]=(0,s.useState)([]),[w,f]=(0,s.useState)(null),[N,y]=(0,s.useState)(""),[C,B]=(0,s.useState)(!1);(0,s.useEffect)(()=>{u&&v(e=>e||u)},[u]);const S=async()=>{const t=p.trim();if(!t)return y((0,e.__)("Bitte gib einen Suchbegriff ein.","child")),void B(!1);x(!0),y(""),j([]),f(null);try{const l=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(t)}&maxResults=5`);if(!l.ok)throw new Error("Request failed");const i=((await l.json()).items||[]).map(e=>{const t=e.volumeInfo||{},l=t?.imageLinks?.thumbnail||t?.imageLinks?.smallThumbnail||"";return{id:e.id,title:t?.title||"",subtitle:t?.subtitle||"",authors:t?.authors||[],cover:n(l)}});j(i),B(!0),i.length||y((0,e.__)("Keine Ergebnisse gefunden.","child"))}catch(t){console.error("Fehler beim Suchen:",t),y((0,e.__)("Beim Suchen ist ein Fehler aufgetreten. Bitte versuche es erneut.","child")),B(!1)}x(!1)};return(0,r.jsxs)("div",{...o,children:[(0,r.jsxs)(l.InspectorControls,{children:[(0,r.jsxs)(i.PanelBody,{title:(0,e.__)("Buch finden","child"),initialOpen:!0,children:[(0,r.jsx)(i.TextControl,{label:(0,e.__)("Suche nach Titel oder Autor","child"),value:p,onChange:v,placeholder:(0,e.__)("Buchtitel eingeben...","child"),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),S())}}),(0,r.jsx)(i.Button,{variant:"primary",onClick:S,disabled:g,className:"book-search-button",children:g?(0,e.__)("Suche...","child"):(0,e.__)("Suchen","child")}),g&&(0,r.jsx)("div",{className:"book-search-loading",children:(0,r.jsx)(i.Spinner,{})}),N&&(0,r.jsx)(i.Notice,{status:"error",isDismissible:!1,children:N}),!g&&C&&(0,r.jsx)(d,{results:k,selectedId:w,onSelect:e=>{const t=e.authors.length?e.authors.join(", "):_;f(e.id),v(e.title),a({bookTitle:e.title||u,author:t,coverUrl:e.cover||m||""})}})]}),(0,r.jsxs)(i.PanelBody,{title:(0,e.__)("Buchdetails","child"),initialOpen:!0,children:[(0,r.jsx)(i.TextControl,{label:(0,e.__)("Titel","child"),value:u,onChange:e=>a({bookTitle:e})}),(0,r.jsx)(i.TextControl,{label:(0,e.__)("Autor","child"),value:_,onChange:e=>a({author:e})}),(0,r.jsx)(i.TextControl,{label:(0,e.__)("Cover-URL","child"),value:m,onChange:e=>a({coverUrl:e}),help:(0,e.__)("Optional: Eigene Cover-Grafik einfÃ¼gen","child")}),(0,r.jsx)(h,{value:b,onChange:e=>a({rating:e})})]})]}),(0,r.jsx)(c,{...t,onRatingChange:e=>a({rating:e})})]})},save:()=>null})}},l={};function i(e){var s=l[e];if(void 0!==s)return s.exports;var a=l[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,l,s,a)=>{if(!l){var r=1/0;for(h=0;h<e.length;h++){for(var[l,s,a]=e[h],n=!0,o=0;o<l.length;o++)(!1&a||r>=a)&&Object.keys(i.O).every(e=>i.O[e](l[o]))?l.splice(o--,1):(n=!1,a<r&&(r=a));if(n){e.splice(h--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var h=e.length;h>0&&e[h-1][2]>a;h--)e[h]=e[h-1];e[h]=[l,s,a]},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={659:0,323:0};i.O.j=t=>0===e[t];var t=(t,l)=>{var s,a,[r,n,o]=l,c=0;if(r.some(t=>0!==e[t])){for(s in n)i.o(n,s)&&(i.m[s]=n[s]);if(o)var h=o(i)}for(t&&t(l);c<r.length;c++)a=r[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(h)},l=globalThis.webpackChunktwentytwentyfive_child_blocks=globalThis.webpackChunktwentytwentyfive_child_blocks||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var s=i.O(void 0,[323],()=>i(539));s=i.O(s)})();