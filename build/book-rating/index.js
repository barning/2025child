(()=>{"use strict";var e,t={539:()=>{const e=window.wp.i18n,t=window.wp.blocks,s=window.wp.blockEditor,l=window.wp.components,i=window.wp.element,r=JSON.parse('{"UU":"child/book-rating"}'),a=window.ReactJSXRuntime,n=e=>{if(!e)return"";let t=e.replace(/^http:\/\//i,"https://");return t.includes("zoom=")&&(t=t.replace(/zoom=\d/g,"zoom=2")),t},o=[1,2,3,4,5],c=({bookTitle:t,author:s,coverUrl:l,rating:i})=>{if(!t?.trim())return(0,a.jsx)("div",{className:"book-preview--empty",children:(0,e.__)("Bitte wÃ¤hle ein Buch aus der Suche aus oder gib die Details manuell ein.","child")});const r=Number.isFinite(i)?Math.max(0,Math.min(5,i)):0;return(0,a.jsxs)("div",{className:"child-book-card","aria-label":(0,e.__)("Buchbewertung","child"),children:[(0,a.jsx)("div",{className:"child-book-card__media",children:l?(0,a.jsx)("img",{className:"child-book-card__cover",src:l,alt:t,loading:"lazy"}):(0,a.jsx)("div",{className:"child-book-card__placeholder","aria-hidden":"true"})}),(0,a.jsxs)("div",{className:"child-book-card__stars","aria-label":(0,e.__)("Bewertung","child"),children:[o.map(e=>(0,a.jsx)("span",{className:"child-book-card__star"+(e<=r?" is-active":""),"aria-hidden":"true",children:"â˜…"},e)),(0,a.jsx)("span",{className:"screen-reader-text",children:(0,e.sprintf)(/* translators: %d: selected star */ /* translators: %d: selected star */
(0,e.__)("Bewertet mit %d von 5 Sternen","child"),r)})]}),(0,a.jsxs)("div",{className:"child-book-card__meta",children:[(0,a.jsx)("h3",{className:"child-book-card__title",children:t}),s?.trim()?(0,a.jsx)("p",{className:"child-book-card__author",children:(0,e.sprintf)(/* translators: %s: author name */ /* translators: %s: author name */
(0,e.__)("Von %s","child"),s)}):null]})]})},h=({value:t=0,onChange:s})=>{const i=Number.isFinite(t)?Math.max(0,Math.min(5,t)):0;return(0,a.jsxs)("div",{className:"book-rating-control",children:[(0,a.jsxs)("div",{className:"book-rating-control__label",children:[(0,a.jsx)("span",{children:(0,e.__)("Bewertung","child")}),(0,a.jsxs)("span",{className:"book-rating-control__value",children:[i,"/5"]})]}),(0,a.jsx)(l.RangeControl,{value:i,min:0,max:5,step:1,onChange:e=>{return t=Number(e)||0,void("function"==typeof s&&s(t));var t},__nextHasNoMarginBottom:!0})]})},d=({results:e,selectedId:t,onSelect:s})=>e.length?(0,a.jsx)("div",{className:"book-search-results",children:e.map(e=>(0,a.jsxs)(l.Button,{variant:e.id===t?"primary":"secondary",onClick:()=>s(e),className:"book-search-result"+(e.id===t?" is-active":""),children:[e.cover?(0,a.jsx)("span",{className:"book-search-result__thumb",children:(0,a.jsx)("img",{src:e.cover,alt:e.title||"",loading:"lazy"})}):(0,a.jsx)("span",{className:"book-search-result__thumb book-search-result__thumb--placeholder","aria-hidden":"true",children:"ðŸ“˜"}),(0,a.jsxs)("span",{className:"book-search-result__details",children:[(0,a.jsx)("span",{className:"book-search-result__title",children:e.title}),e.subtitle?(0,a.jsx)("span",{className:"book-search-result__subtitle",children:e.subtitle}):null,e.authors.length?(0,a.jsx)("span",{className:"book-search-result__author",children:e.authors.join(", ")}):null]})]},e.id))}):null;(0,t.registerBlockType)(r.UU,{edit:function({attributes:t,setAttributes:r}){const o=(0,s.useBlockProps)(),{bookTitle:u,author:_,rating:b,coverUrl:m}=t,[v,p]=(0,i.useState)(""),[x,g]=(0,i.useState)(!1),[k,j]=(0,i.useState)([]),[w,f]=(0,i.useState)(null),[N,y]=(0,i.useState)(""),[C,B]=(0,i.useState)(!1);(0,i.useEffect)(()=>{u&&p(e=>e||u)},[u]);const S=async()=>{const t=v.trim();if(!t)return y((0,e.__)("Bitte gib einen Suchbegriff ein.","child")),void B(!1);g(!0),y(""),j([]),f(null);try{const s=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(t)}&maxResults=5`);if(!s.ok)throw new Error("Request failed");const l=((await s.json()).items||[]).map(e=>{const t=e.volumeInfo||{},s=t?.imageLinks?.thumbnail||t?.imageLinks?.smallThumbnail||"";return{id:e.id,title:t?.title||"",subtitle:t?.subtitle||"",authors:t?.authors||[],cover:n(s)}});j(l),B(!0),l.length||y((0,e.__)("Keine Ergebnisse gefunden.","child"))}catch(t){console.error("Fehler beim Suchen:",t),y((0,e.__)("Beim Suchen ist ein Fehler aufgetreten. Bitte versuche es erneut.","child")),B(!1)}g(!1)};return(0,a.jsxs)("div",{...o,children:[(0,a.jsxs)(s.InspectorControls,{children:[(0,a.jsxs)(l.PanelBody,{title:(0,e.__)("Buch finden","child"),initialOpen:!0,children:[(0,a.jsx)(l.TextControl,{label:(0,e.__)("Suche nach Titel oder Autor","child"),value:v,onChange:p,placeholder:(0,e.__)("Buchtitel eingeben...","child"),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),S())}}),(0,a.jsx)(l.Button,{variant:"primary",onClick:S,disabled:x,className:"book-search-button",children:x?(0,e.__)("Suche...","child"):(0,e.__)("Suchen","child")}),x&&(0,a.jsx)("div",{className:"book-search-loading",children:(0,a.jsx)(l.Spinner,{})}),N&&(0,a.jsx)(l.Notice,{status:"error",isDismissible:!1,children:N}),!x&&C&&(0,a.jsx)(d,{results:k,selectedId:w,onSelect:e=>{const t=e.authors.length?e.authors.join(", "):_;f(e.id),p(e.title),r({bookTitle:e.title||u,author:t,coverUrl:e.cover||m||""})}})]}),(0,a.jsxs)(l.PanelBody,{title:(0,e.__)("Buchdetails","child"),initialOpen:!0,children:[(0,a.jsx)(l.TextControl,{label:(0,e.__)("Titel","child"),value:u,onChange:e=>r({bookTitle:e})}),(0,a.jsx)(l.TextControl,{label:(0,e.__)("Autor","child"),value:_,onChange:e=>r({author:e})}),(0,a.jsx)(l.TextControl,{label:(0,e.__)("Cover-URL","child"),value:m,onChange:e=>r({coverUrl:e}),help:(0,e.__)("Optional: Eigene Cover-Grafik einfÃ¼gen","child")}),(0,a.jsx)(h,{value:b,onChange:e=>r({rating:e})})]})]}),(0,a.jsx)(c,{...t})]})},save:()=>null})}},s={};function l(e){var i=s[e];if(void 0!==i)return i.exports;var r=s[e]={exports:{}};return t[e](r,r.exports,l),r.exports}l.m=t,e=[],l.O=(t,s,i,r)=>{if(!s){var a=1/0;for(h=0;h<e.length;h++){for(var[s,i,r]=e[h],n=!0,o=0;o<s.length;o++)(!1&r||a>=r)&&Object.keys(l.O).every(e=>l.O[e](s[o]))?s.splice(o--,1):(n=!1,r<a&&(a=r));if(n){e.splice(h--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[s,i,r]},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={659:0,323:0};l.O.j=t=>0===e[t];var t=(t,s)=>{var i,r,[a,n,o]=s,c=0;if(a.some(t=>0!==e[t])){for(i in n)l.o(n,i)&&(l.m[i]=n[i]);if(o)var h=o(l)}for(t&&t(s);c<a.length;c++)r=a[c],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(h)},s=globalThis.webpackChunktwentytwentyfive_child_blocks=globalThis.webpackChunktwentytwentyfive_child_blocks||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=l.O(void 0,[323],()=>l(539));i=l.O(i)})();