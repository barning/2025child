(()=>{"use strict";var e,t={539:()=>{const e=window.wp.i18n,t=window.wp.blocks,i=window.wp.blockEditor,o=window.wp.components,r=window.wp.element,n=JSON.parse('{"UU":"child/book-rating"}'),s=window.ReactJSXRuntime,l=e=>{if(!e)return"";let t=e.replace(/^http:\/\//i,"https://");return t.includes("zoom=")&&(t=t.replace(/zoom=\d/g,"zoom=2")),t},a=({bookTitle:t,author:i,coverUrl:o,rating:r,onRatingChange:n})=>{if(!t?.trim())return(0,s.jsx)("div",{className:"book-preview--empty",children:(0,e.__)("Bitte wähle ein Buch aus der Suche aus oder gib die Details manuell ein.","child")});const l=Number.isFinite(r)?Math.max(0,Math.min(5,r)):0;return(0,s.jsxs)("div",{className:"book-display","aria-label":(0,e.__)("Buchbewertung","child"),children:[(0,s.jsxs)("div",{className:"book-display__card",children:[o?(0,s.jsx)("div",{className:"book-cover-frame",children:(0,s.jsx)("img",{className:"book-cover",src:o,alt:t,loading:"lazy"})}):(0,s.jsx)("div",{className:"book-cover book-cover--placeholder","aria-hidden":"true"}),(0,s.jsx)("div",{className:"book-rating","aria-label":(0,e.__)("Bewertung","child"),children:[1,2,3,4,5].map(t=>(0,s.jsx)("button",{type:"button",className:"star-button"+(t<=l?" active":""),onClick:()=>{"function"==typeof n&&n(t)},"aria-pressed":t<=l,"aria-label":(0,e.sprintf)(/* translators: %d: selected star */ /* translators: %d: selected star */
(0,e.__)("Bewertung mit %d Sternen wählen","child"),t),children:"★"},t))})]}),(0,s.jsxs)("div",{className:"book-info",children:[(0,s.jsx)("h3",{className:"book-title",children:t}),i?.trim()?(0,s.jsx)("p",{className:"book-author",children:(0,e.sprintf)(/* translators: %s: author name */ /* translators: %s: author name */
(0,e.__)("Von %s","child"),i)}):null]})]})};(0,t.registerBlockType)(n.UU,{edit:function({attributes:t,setAttributes:n}){const c=(0,i.useBlockProps)(),{bookTitle:h,author:u,rating:d,coverUrl:m}=t,[b,v]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),[k,_]=(0,r.useState)([]),[x,f]=(0,r.useState)(null),[w,j]=(0,r.useState)(""),[y,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{h&&v(e=>e||h)},[h]);const B=async()=>{const t=b.trim();if(!t)return j((0,e.__)("Bitte gib einen Suchbegriff ein.","child")),void N(!1);g(!0),j(""),_([]),f(null);try{const i=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(t)}&maxResults=5`);if(!i.ok)throw new Error("Request failed");const o=((await i.json()).items||[]).map(e=>{const t=e.volumeInfo?.imageLinks?.thumbnail||e.volumeInfo?.imageLinks?.smallThumbnail||"";return{id:e.id,title:e.volumeInfo?.title||"",authors:e.volumeInfo?.authors||[],categories:e.volumeInfo?.categories||[],cover:l(t)}});_(o),N(!0),o.length||j((0,e.__)("Keine Ergebnisse gefunden.","child"))}catch(t){console.error("Fehler beim Suchen:",t),j((0,e.__)("Beim Suchen ist ein Fehler aufgetreten. Bitte versuche es erneut.","child")),N(!1)}g(!1)};return(0,s.jsxs)("div",{...c,children:[(0,s.jsx)(i.InspectorControls,{children:(0,s.jsxs)(o.PanelBody,{title:(0,e.__)("Buchdetails","child"),children:[(0,s.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,s.jsx)(o.TextControl,{label:(0,e.__)("Suche nach Titel oder Autor","child"),value:b,onChange:v,placeholder:(0,e.__)("Buchtitel eingeben...","child"),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),B())}}),(0,s.jsx)(o.Button,{isPrimary:!0,onClick:B,disabled:p,style:{marginTop:"0.5rem"},children:p?(0,e.__)("Suche...","child"):(0,e.__)("Suchen","child")}),p&&(0,s.jsx)("div",{className:"book-search-loading",children:(0,s.jsx)(o.Spinner,{})}),w&&(0,s.jsx)(o.Notice,{status:"error",isDismissible:!1,children:w}),!p&&y&&k.length>0&&(0,s.jsx)("div",{className:"book-search-results",children:k.map(e=>(0,s.jsxs)(o.Button,{variant:e.id===x?"primary":"secondary",onClick:()=>(e=>{const t=e.authors.length?e.authors.join(", "):u;f(e.id),v(e.title),n({bookTitle:e.title||h,author:t,coverUrl:e.cover||m||""})})(e),className:"book-search-result",children:[(0,s.jsx)("span",{className:"book-search-result__title",children:e.title}),e.authors.length>0&&(0,s.jsx)("span",{className:"book-search-result__author",children:e.authors.join(", ")})]},e.id))})]}),(0,s.jsx)(o.TextControl,{label:(0,e.__)("Titel","child"),value:h,onChange:e=>n({bookTitle:e})}),(0,s.jsx)(o.TextControl,{label:(0,e.__)("Autor","child"),value:u,onChange:e=>n({author:e})}),(0,s.jsxs)("div",{className:"book-rating-control",children:[(0,s.jsx)("label",{children:(0,e.__)("Bewertung","child")}),(0,s.jsx)("div",{className:"star-rating",children:[1,2,3,4,5].map(e=>(0,s.jsx)("button",{type:"button",className:"star-button "+(e<=d?"active":""),onClick:()=>n({rating:e}),children:"★"},e))})]})]})}),(0,s.jsx)(a,{...t,onRatingChange:e=>n({rating:e})})]})},save:()=>null})}},i={};function o(e){var r=i[e];if(void 0!==r)return r.exports;var n=i[e]={exports:{}};return t[e](n,n.exports,o),n.exports}o.m=t,e=[],o.O=(t,i,r,n)=>{if(!i){var s=1/0;for(h=0;h<e.length;h++){for(var[i,r,n]=e[h],l=!0,a=0;a<i.length;a++)(!1&n||s>=n)&&Object.keys(o.O).every(e=>o.O[e](i[a]))?i.splice(a--,1):(l=!1,n<s&&(s=n));if(l){e.splice(h--,1);var c=r();void 0!==c&&(t=c)}}return t}n=n||0;for(var h=e.length;h>0&&e[h-1][2]>n;h--)e[h]=e[h-1];e[h]=[i,r,n]},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={659:0,323:0};o.O.j=t=>0===e[t];var t=(t,i)=>{var r,n,[s,l,a]=i,c=0;if(s.some(t=>0!==e[t])){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(a)var h=a(o)}for(t&&t(i);c<s.length;c++)n=s[c],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(h)},i=globalThis.webpackChunktwentytwentyfive_child_blocks=globalThis.webpackChunktwentytwentyfive_child_blocks||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=o.O(void 0,[323],()=>o(539));r=o.O(r)})();